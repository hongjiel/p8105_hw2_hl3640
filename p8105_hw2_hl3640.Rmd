---
title: "Homework 2"
author: "Hongjie Liu"
output: github_document
---


Load package `tidyverse` for homework 2.

```{r loadpackages, message = FALSE}
library(tidyverse)
```


## Problem 1

Read and clean the data; retain line, station, name, station latitude / longitude, routes served, entry, vending, entrance type, and ADA compliance. Convert the entry variable from character (`YES` vs `NO`) to a logical variable.

```{r p1_tidydata}
transit_df_original = read_csv(file = "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv")
transit_df = transit_df_original %>% 
  janitor::clean_names() %>% 
  select(line:entry, vending, ada) %>% 
  mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE))
```

The variables that the original dataset contains are ``r names(transit_df_original)``.

First, We read the data from the csv file "NYC_Transit_Subway_Entrance_And_Exit_Data.csv". Next, we use the function `janitor::clean_names` to clean up variable names. Last, We use the functions `recode` and `mutate` to convert the entry variable from character (`YES` vs `NO`) to a logical variable.

The resulting dataset has `r nrow(transit_df)` rows and `r ncol(transit_df)` columns.

These data are still not tidy, because the values of the variables `route8` to `route11` is numeric and should be converted to character, and route number and route name are not distinct variables.

```{r p1_stnum}
stnum = transit_df %>% 
  select(station_name, line) %>% 
  distinct %>% 
  count
```

There are `r stnum` distinct stations.

```{r p1_stnum_ada}
stnum_ada = transit_df %>% 
  filter(ada == TRUE) %>% 
  select(station_name, line) %>% 
  distinct %>% 
  count
```

`r stnum_ada` stations are ADA compliant.

```{r p1_stnum_novd}
total = transit_df %>% 
  filter(vending == "NO") %>% 
  pull(entry)
  
entrynum = sum(total == TRUE)
exitnum = sum(total == FALSE)
```

The ratio of entrances to exits with no vending allow entrance is 1:`r round(exitnum/entrynum, 2)`.

Reformat data so that route number and route name are distinct variables.

```{r p1_reformat}
transit_df$route8 = as.character(transit_df$route8)
transit_df$route9 = as.character(transit_df$route9)
transit_df$route10 = as.character(transit_df$route10)
transit_df$route11 = as.character(transit_df$route11)

transit_df = transit_df %>% 
  pivot_longer(
    route1:route11,
    names_to = "route_number",
    values_to = "route_name") %>% 
  mutate(route_number = str_replace(route_number, "route", ""))
```

```{r p1_stnum_a}
stnum_a = transit_df %>% 
  filter(route_name == "A") %>% 
  select(station_name, line) %>% 
  distinct %>% 
  count

stnum_a_ada = transit_df %>% 
  filter(route_name == "A", ada == TRUE) %>% 
  select(station_name, line) %>% 
  distinct %>% 
  count
```

`r stnum_a` stations serve the A train, of which `r stnum_a_ada` are ADA compliant.
